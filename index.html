<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulaire</title>
    <style>
        .error-message {
            color: red;
        }
    </style>
</head>

<body>
    <h1>Formulaire</h1>

    <div id="errorMessages" class="error-message"></div>

    <form id="myForm">
        <label for="pseudo">Pseudo:</label>
        <input type="text" id="pseudo" name="pseudo" required><br>

        <label for="role">Mon Rôle:</label>
        <select id="role" name="role" required>
            <option value="">Sélectionnez un rôle</option>
            <option value="heal">Heal</option>
            <option value="tank">Tank</option>
            <option value="dps-distant">Dps Distant</option>
            <option value="dps-cac">Dps CAC</option>
        </select><br>

        <div id="questionContainer" style="display:none;">
            <label for="question3">Question 3:</label>
            <select id="question3" name="question3" required></select><br>
        </div>

        <button type="button" onclick="submitForm()">Soumettre</button>
    </form>

    <div id="confirmationMessage"></div>
    
    <script>
        var roleSelect = document.getElementById("role");
        var questionContainer = document.getElementById("questionContainer");
        var question3Select = document.getElementById("question3");
        
        // Options de la troisième question en fonction du rôle sélectionné
        var roleOptions = {
            heal: ["Chaman", "Prêtre", "Paladin", "Evoker", "Druide", "Moine"],
            tank: ["War", "Moine", "Druide", "DH", "Paladin"],
            'dps-distant': ["Toto", "Tata"],
            'dps-cac': ["TITI", "TOTO"]
        };
        
        // Mettre à jour les options de la troisième question lorsque le rôle change
        roleSelect.addEventListener("change", function() {
            var selectedRole = roleSelect.value;
            if (selectedRole) {
                questionContainer.style.display = "block"; // Afficher le conteneur de la question 3
                question3Select.innerHTML = ""; // Effacer les anciennes options
        
                // Ajouter les nouvelles options basées sur le rôle sélectionné
                roleOptions[selectedRole].forEach(function(option) {
                    var newOption = document.createElement("option");
                    newOption.text = option;
                    question3Select.add(newOption);
                });
            } else {
                questionContainer.style.display = "none"; // Masquer le conteneur de la question 3 si aucun rôle n'est sélectionné
                question3Select.innerHTML = ""; 
            }
        });
        

        function submitForm() {
            var errors = [];
            var pseudo = document.getElementById("pseudo").value;
            var role = document.getElementById("role").value;
            var question3 = document.getElementById("question3").value;

            // Vérifier si le champ "Pseudo" est rempli
            if (!pseudo) {
                errors.push("Veuillez saisir votre pseudo.");
            }

            // Vérifier si le rôle a été sélectionné
            if (!role) {
                errors.push("Veuillez sélectionner un rôle.");
            }

            // Afficher les messages d'erreur
            var errorMessages = document.getElementById("errorMessages");
            errorMessages.innerHTML = errors.join("<br>");

            // Si aucune erreur, stocker les réponses
            if (errors.length === 0) {
                var response = {
                    pseudo: pseudo,
                    role: role,
                    question3: question3
                };

                var storedResponses = JSON.parse(localStorage.getItem('responses')) || [];
                storedResponses.push(response);
                localStorage.setItem('responses', JSON.stringify(storedResponses));

                // Réinitialiser le formulaire
                document.getElementById("myForm").reset();

                // Effacer les messages d'erreur après soumission réussie
                errorMessages.innerHTML = "";

                var confirmationMessage = document.getElementById("confirmationMessage");
                confirmationMessage.innerHTML = "Formulaire soumis avec succès!<br>";
                confirmationMessage.innerHTML += "Pseudo: " + pseudo + "<br>";
                confirmationMessage.innerHTML += "Rôle: " + role + "<br>";
                confirmationMessage.innerHTML += "Question 3: " + question3;
                
            }
        }
    </script>
</body>

</html>
